# js

> [什么是闭包，闭包的用途](https://juejin.im/post/6844903990656761864)

- 什么是闭包
  - 能够读取其他函数内部变量的函数，或者简单点定义在一个函数内部的函数，内部函数持有外部函数的变量的引用。
  - 在一个函数里面定义另一个函数。而这个内部函数一直保持有对外部函数中作用域的访问权限。
- 函数作用域
  
- 作用域的感念，可以认为他是一个封闭的空间，只允许在这个封闭的空间内进行一些操作，也将这个封闭空间称为私有作用域。在`js`中，一个函数的执行就会在内存中创建一个私有作用域----封闭空间。（在函数执行的时候，函数会在内存中创建私有作用域，当这个函数执行完毕之后，这个私有作用域会销毁）。注意：只有一种情况是不销毁的，就是`“闭包”`。
  
- 内存回收机制
  - 内存回收机制就是不再用到的内存，我们系统就自动进行回收从而清理出空间给其他程序提供。
  - 规则：内部函数引用外部函数的变量，当外部函数执行完毕之后，作用域也不会被销毁。形成了一种不销毁的私有作用域。某一变量或者对象呗引用着，所以在回收的时候不会释放，回收器不会对正在使用的变量或对象回收的。

- 作用域继承
  
- 作用域继承，就像是儿子可以继承父亲财产一样。（大盒子中放一个小盒子，小盒子能取到大盒子里面的东西，大盒子不能取到小盒子里面的东西。在`js`中，在一个函数里面声明另一个函数，内部函数可以访问外部函数的变量，而外部函数不能访问内部函数的变量）
  
- 闭包的作用是什么
  
- 保护和保存
  
- 经典的闭包面试题

  - 循环绑定时间引发的索引问题？怎么解决这种问题？

    ```js
    var btn = $('#btnbox'),inputs = $('input');
    var len = inputs.length
    for(var i = 0;i<= len;i++){
        inputs[i].onclick = function(){
            alert(i)
        }
    }
    ```

    ``` html
    <div id="btnbox"></div>
    <input type="text">
    <input type="text">
    <input type="text">
    <input type="text">
    <input type="text">
    <input type="text">
    ```

  
- 所有的事件绑定都是异步的，当触发点击事件，执行方法的时候，循环早就已经结束。
  - 同步：js中，如果当前任务没有完成结束之前，后面的任务都不会执行，只有当前彻底完成之后，才会执行后面的任务。
  - 异步：将请求放在队列里面，当同步任务执行完成之后，会进入队列读取任务队列。

> `call`,`apply`,`bind`区别？怎么实现`call,apply`方法

- 相似：
  - 都是用来改变函数`this`的指向的。
  - 第一个参数都是`this`要指向的对象。
  - 都可以利用后续参数传参。

- 区别：
  - `call`的传参方式：`fn.call(this,1,2,3)`
  - `apply`的传参方式：`fn.apply(this,[1,2,3])`
  - `bind`的返回值为一个新的函数，需要再次调用：`fn.bind(this)(1,2,3)`